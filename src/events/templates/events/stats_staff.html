{% extends "base.html" %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block style %}
    <link rel="stylesheet" href="{% static 'css/events.css' %}">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
{% endblock style %}

{% block head_title %}{{ title }} | {{ block.super }}{% endblock %}

{% block content %}

    <h1>{{ heading }} <small class="responsive-wrap">{{ date_object }}</small></h1>

    {%  include 'events/date_filter.html' %}

    <table data-toggle="table"
           data-classes="table table-no-bordered table-condensed"
           data-search="true"
           data-id-field="id"
           data-sort-name="last"
           data-sort-order="asc"
           id="table">
        <thead>
        <tr>
            <th data-field="id" data-sortable="true">Number</th>
            <th data-field="first" data-sortable="true">First Name</th>
            <th data-field="last" data-sortable="true">Last Name</th>
            <th data-field="count" data-sortable="true">Students</th>
            {% for block in blocks %}
                <th data-field="noreg-num-{{ block }}" data-sortable="true">No reg #</th>
                <th data-field="noreg-percent-{{ block }}" data-sortable="true">No reg %</th>
            {% endfor %}

        </tr>
        </thead>
        <tbody>
            {% for teacher, stats in staff_stats.items %}
            <tr>
                <td>{{ teacher.username }}</td>
                <td>{{ teacher.first_name }}</td>
                <td>{{ teacher.last_name }}</td>
                {% for label, value in stats.items %}
                    <td>{{ value }}{% if "%" in label %}%{% endif %}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock content %}

{% block js %}
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    {#  Date Filter#}
    <script src="{% static 'js/events-datepicker.js' %}"></script>

    <!-- Bootstrap Tables:  http://bootstrap-table.wenzhixin.net.cn/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/bootstrap-table.min.js"></script>

    {#  Confirm password reset#}
    <script>
        $(document).ready(function() {
            $('.reset-password').click(function() {
                console.log(this);
                if (confirm('Reset password to "wolf" for user ' + $(this).data('user') + "?")) {
                    var url = $(this).attr('href');
                    $('#content').load(url);
                }
                else
                    return false
            });
        });
    </script>
{% endblock js %}